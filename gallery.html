<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Gallery</title>

<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  .img-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 12px;
  }
  img {
    width: 100%;
    border: 1px solid #ccc;
  }
</style>

</head>
<body>

<h1 id="title">Gallery</h1>

<label>Book:</label>
<select id="bookSelect"></select>

<div class="img-grid" id="grid"></div>

<script>

const bookSelect = document.getElementById("bookSelect");
const titleEl = document.getElementById("title");
const grid = document.getElementById("grid");

// ------------------------------------------------------------
// Load the list of books from books/index.json
// ------------------------------------------------------------
fetch("books/index.json")
  .then(r => r.json())
  .then(data => {
    const books = data.books;

    // Populate dropdown
    books.forEach(book => {
      const opt = document.createElement("option");
      opt.value = book;
      opt.textContent = book;
      bookSelect.appendChild(opt);
    });

    // Support ?book= parameter
    const params = new URLSearchParams(window.location.search);
    const urlBook = params.get("book");

    if (urlBook && books.includes(urlBook)) {
      bookSelect.value = urlBook;
      loadBook(urlBook);
    }
  });

// ------------------------------------------------------------
// When user selects a book
// ------------------------------------------------------------
bookSelect.addEventListener("change", () => {
  loadBook(bookSelect.value);
});

// ------------------------------------------------------------
// Load images from books/<book>/index.json
// ------------------------------------------------------------
function loadBook(book) {
  titleEl.textContent = "Gallery: " + book;
  grid.innerHTML = "";

  fetch(`books/${book}/index.json`)
    .then(r => r.json())
    .then(data => {
      data.images.forEach(file => {
        const img = document.createElement("img");
        img.src = `books/${book}/${file}`;
        grid.appendChild(img);
      });
    })
    .catch(err => {
      titleEl.textContent = "Error loading gallery";
      console.error(err);
    });
}

</script>

</body>
</html>


