<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Gallery</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    h1 { margin-bottom: 20px; }
    .img-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 15px;
    }
    .img-grid img {
      width: 100%;
      height: auto;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>

<h1 id="title">Gallery</h1>
<div class="img-grid" id="grid"></div>

<script>
const params = new URLSearchParams(window.location.search);
const book = params.get("book");

const titleEl = document.getElementById("title");
const grid = document.getElementById("grid");

if (!book) {
  titleEl.innerText = "No book selected.";
} else {
  titleEl.innerText = book.toUpperCase();
  loadGallery(book);
}

function loadGallery(book) {
  // IMPORTANT â€” correct relative path
  const folder = "images/" + book + "/";

  let missingCount = 0;
  let page = 1;

  function tryLoad() {
    const n = String(page).padStart(3, "0");
    const img = new Image();
    img.src = folder + n + ".webp";

    img.onload = () => {
      grid.appendChild(img);
      page++;
      missingCount = 0;   // found a valid page
      tryLoad();          // load next
    };

    img.onerror = () => {
      missingCount++;
      page++;
      if (missingCount < 5) {
        tryLoad();        // try next possible page
      }
    };
  }

  tryLoad();
}
</script>

</body>
</html>
